<div class="panel-container" (click)="$event.stopPropagation()">
  <!-- Panel Header -->
  <div class="panel-header">
    <div class="header-content">
      <h3 class="panel-title">Work Order Details</h3>
      <p class="panel-subtitle">Specify the dates, name and status for this order</p>
    </div>
    <div class="header-actions">
      <button 
        type="button" 
        class="btn btn-secondary" 
        (click)="onCancel()"
        [disabled]="isSubmitting()"
      >
        Cancel
      </button>
      <button 
        type="submit" 
        class="btn btn-primary" 
        (click)="onSubmit()"
        [disabled]="isSubmitting()"
      >
        @if (isSubmitting()) {
          <span class="spinner"></span>
        }
        {{ submitButtonText }}
      </button>
    </div>
  </div>

  <!-- Panel Body -->
  <div class="panel-body">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <!-- Work Order Name -->
      <div class="form-group">
        <label class="form-label" for="name">Work Order Name</label>
        <input
          type="text"
          id="name"
          class="form-input"
          formControlName="name"
          placeholder="Enter work order name"
          [class.error]="hasError('name')"
        />
        @if (hasError('name')) {
          <span class="error-message">Work order name is required</span>
        }
      </div>

      <!-- Status -->
      <div class="form-group">
        <label class="form-label" for="status">Status</label>
        <ng-select
          id="status"
          class="status-select"
          formControlName="status"
          [items]="statusOptions"
          bindLabel="label"
          bindValue="value"
          [clearable]="false"
          [searchable]="false"
          appendTo="body"
        >
          <ng-template ng-label-tmp let-item="item">
            <span class="status-option" [ngClass]="'status-' + item.value.toLowerCase().replace(' ', '-')">
              {{ item.label }}
            </span>
          </ng-template>
          <ng-template ng-option-tmp let-item="item">
            <span class="status-option" [ngClass]="'status-' + item.value.toLowerCase().replace(' ', '-')">
              {{ item.label }}
            </span>
          </ng-template>
        </ng-select>
      </div>

      <!-- End Date -->
      <div class="form-group">
        <label class="form-label" for="endDate">End date</label>
        <div class="date-input-wrapper">
          <input
            type="text"
            id="endDate"
            class="form-input date-input"
            placeholder="MM.DD.YYYY"
            ngbDatepicker
            #endPicker="ngbDatepicker"
            formControlName="endDate"
            (click)="endPicker.toggle()"
            readonly
            [class.error]="hasError('endDate')"
          />
          <button type="button" class="date-btn" (click)="endPicker.toggle()">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M12.667 2.667H3.333C2.597 2.667 2 3.264 2 4v9.333c0 .737.597 1.334 1.333 1.334h9.334c.736 0 1.333-.597 1.333-1.334V4c0-.736-.597-1.333-1.333-1.333zM10.667 1.333v2.667M5.333 1.333v2.667M2 6.667h12" stroke="#687196" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
        @if (hasError('endDate')) {
          <span class="error-message">End date is required</span>
        }
      </div>

      <!-- Start Date -->
      <div class="form-group">
        <label class="form-label" for="startDate">Start date</label>
        <div class="date-input-wrapper">
          <input
            type="text"
            id="startDate"
            class="form-input date-input"
            placeholder="MM.DD.YYYY"
            ngbDatepicker
            #startPicker="ngbDatepicker"
            formControlName="startDate"
            (click)="startPicker.toggle()"
            readonly
            [class.error]="hasError('startDate')"
          />
          <button type="button" class="date-btn" (click)="startPicker.toggle()">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M12.667 2.667H3.333C2.597 2.667 2 3.264 2 4v9.333c0 .737.597 1.334 1.333 1.334h9.334c.736 0 1.333-.597 1.333-1.334V4c0-.736-.597-1.333-1.333-1.333zM10.667 1.333v2.667M5.333 1.333v2.667M2 6.667h12" stroke="#687196" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
        @if (hasError('startDate')) {
          <span class="error-message">Start date is required</span>
        }
      </div>

      <!-- Work Center (Hidden in design but keeping for functionality) -->
      <input type="hidden" formControlName="workCenterId" />

      <!-- Overlap Error -->
      @if (overlapError()) {
        <div class="overlap-error">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M8 5.333V8M8 10.667h.007M14.667 8A6.667 6.667 0 111.333 8a6.667 6.667 0 0113.334 0z" stroke="#E74C3C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span>{{ overlapError() }}</span>
        </div>
      }
    </form>
  </div>
</div>
